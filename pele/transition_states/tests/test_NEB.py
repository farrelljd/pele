import unittest

import numpy as np

from pele.transition_states import NEBDriver
from pele.potentials import LJ


_x1 = np.array([ 0.68695696, -0.14524368,  0.59801728,  0.90404638, -1.10361935,
                 0.02502333, -0.13053775, -0.02231432, -1.04641403, -0.94141393,
                -0.0078097 , -0.24879046,  0.39880696, -1.0276447 , -0.99129086,
                -0.43617442, -0.08378408,  0.76752377, -0.91321808, -1.00417607,
                 0.29929082,  0.04754886,  0.52303975, -0.06416766, -0.08491616,
                -1.63446861, -0.15959967,  0.09317022, -1.08911469,  0.82264683,
                -0.72432434, -0.96618525, -0.82178433, -0.0186837 , -0.55571441,
                -0.11188353,  0.87585079, -0.10725306, -0.52305795])
_x2 = np.array([ 0.69120809,  0.10341826,  0.15899987, -0.09044153, -0.45542463,
                 0.67826984,  0.11842236, -0.74110503, -0.34466275, -0.94586038,
                -0.88634546,  1.19068949, -1.01887483,  0.15329603,  0.78772864,
                -0.38365196,  0.26503929, -0.10892799, -0.36301327, -0.03303191,
                 1.66816691, -0.67456301, -0.32338027, -0.99432831,  0.35363483,
                 0.17299014, -0.92301388, -0.0058787 ,  0.64232789,  0.85798894,
                 0.12219077, -1.02649276,  1.58738564,  0.71491456, -0.08459307,
                 1.30587932, -0.94938891, -0.68859281,  0.04520994])


class TestNEB(unittest.TestCase):
    def test1(self):
        np.random.seed(0)

        pot = LJ()

        neb = NEBDriver(pot, _x1, _x2, adjustk_freq=10, adaptive_nimages=True, adaptive_niter=True, reinterpolate=10)
        neb.run()


if __name__ == "__main__":
    unittest.main()

